function [freq, t, y] = simulate_IRMA(opt)
    % Set params
    default_params = struct('alpha1', 0, 'alpha2', 1.49e-4, 'alpha3', 3e-3,...
                            'alpha4', 7.4e-4, 'alpha5', 6.1e-4',...
                            'v1', 0.04, 'v2', 0.026, 'v3', 0.02, 'v4', 0.014, 'v5', 0.018,...
                            'k1', 0, 'k2', 0.00035, 'k3', 0.037, 'k4', 0.01, 'k5', 1.884, 'k6', 0.0477,...
                            'h1', 0, 'h2', 1, 'h3', 4, 'h4', 1, 'h5', 4, 'h6', 4, 'h7', 4,...
                            'd1', 0.022, 'd2', 0.047, 'd3', 0.421, 'd4', 0.098, 'd5', 0.05,...
                            'gamma', 0.6,...
                            'tspan', [0 2000],...
                            'x0', zeros(1,5));

    if(nargin == 1)
        params = get_params(default_params, opt);
    else
        params = default_params;
    end
    
    

    % Run simulation
    [t, y] = ode45(@ODE_IRMA, params.tspan, params.x0, [],...
                   params.alpha1, params.alpha2, params.alpha3, params.alpha4, params.alpha5,...
                   params.v1, params.v2, params.v3, params.v4, params.v5,...
                   params.k1, params.k2, params.k3, params.k4, params.k5, params.k6,...
                   params.h1, params.h2, params.h3, params.h4, params.h5, params.h6, params.h7,...
                   params.d1, params.d2, params.d3, params.d4, params.d5,...
                   params.gamma);

    % Find oscillation frequency
    freq = freqfind(t, y, params.tspan(2));
end